<!DOCTYPE html>
<html style="height: 100%">
<head>
    <meta charset="utf-8">
    <title>ç¦å»ºçœæ£®æ—èµ„æºç»¼åˆæ¦‚è§ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        .chart-footer {
            padding: 12px 30px;
            font-size: 13px;
            color: #555;
            background-color: #f9fcf9;
            border-top: 1px solid #e0e6e0;
            font-family: "Microsoft YaHei", sans-serif;
            flex-shrink: 0;
            line-height: 1.6;
        }
        .footer-label {
            font-weight: bold;
            color: #238b45;
        }
    </style>
</head>
<body style="height: 100%; margin: 0; display: flex; flex-direction: column; overflow: hidden;">
    
    <div id="container" style="flex: 1; min-height: 0;"></div>
    <div id="loading" style="position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); color:#999; font-family: sans-serif;">
        æ­£åœ¨åŠ è½½åœ°å›¾æ•°æ®...
    </div>

    <div class="chart-footer">
        <div><span class="footer-label">æ³¨ï¼š</span>ä¸‰æ˜ã€å—å¹³ã€é¾™å²©ä¸‰å¸‚æ£®æ—è“„ç§¯é‡åˆè®¡å å…¨çœè¿‘70%ï¼Œæ˜¯åå‰¯å…¶å®çš„â€œç»¿è‰²é‡‘åº“â€ã€‚</div>
        <div style="margin-top: 5px;"><span class="footer-label">æ•°æ®æ¥æºï¼š</span>ã€Š2023å¹´ç¦å»ºçœç”Ÿæ€ç¯å¢ƒçŠ¶å†µå…¬æŠ¥ã€‹</div>
    </div>

    <script type="text/javascript">
        document.oncontextmenu = function() { return false; };
        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);
        var option;

        myChart.showLoading();

        $.get('fujian.json', function (geoJson) {
            
            myChart.hideLoading();
            document.getElementById('loading').style.display = 'none';
            echarts.registerMap('fujian', geoJson);

            option = {
                backgroundColor: 'transparent',

                // ã€1. åŒæ ‡é¢˜é…ç½®ã€‘
                title: [
                    { // ä¸»æ ‡é¢˜
                        text: '2023å¹´ç¦å»ºçœå„è®¾åŒºå¸‚æ£®æ—è¦†ç›–ç‡',
                        left: 'center', top: 20,
                        textStyle: { color: '#333', fontSize: 24, fontWeight: 'bold' }
                    },
                    { // å°å›¾è¡¨æ ‡é¢˜ (å·¦ä¸Šè§’)
                        text: 'ğŸŒ² æ£®æ—è“„ç§¯é‡ Top 3',
                        subtext: 'å•ä½ï¼šäº¿ç«‹æ–¹ç±³',
                        left: '2%', top: '10%', // å®šä½åœ¨å·¦ä¸Šè§’
                        textStyle: { fontSize: 16, fontWeight: 'bold', color: '#238b45' },
                        subtextStyle: { fontSize: 12 }
                    }
                ],

                // ã€2. æ™ºèƒ½æç¤ºæ¡†ã€‘
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(255,255,255,0.95)',
                    borderColor: '#238b45', borderWidth: 1,
                    textStyle: { color: '#333' },
                    formatter: function (params) {
                        // åˆ¤æ–­æ˜¯åœ°å›¾è¿˜æ˜¯æŸ±çŠ¶å›¾
                        if (params.seriesType === 'map') {
                            if (isNaN(params.value)) return params.name + '<br/><span style="color:#999">æ•°æ®æš‚ç¼º</span>';
                            return params.name + '<br/>æ£®æ—è¦†ç›–ç‡: <b>' + params.value + '%</b>';
                        } else {
                            // æŸ±çŠ¶å›¾æç¤º
                            return params.name + '<br/>æ£®æ—è“„ç§¯é‡: <b>' + params.value + '</b> äº¿mÂ³';
                        }
                    }
                },

                // ã€3. å°å›¾è¡¨çš„åæ ‡ç³» (Grid)ã€‘
                grid: {
                    left: '2%', top: '18%', 
                    width: '20%', height: '20%', // æ§åˆ¶å°å›¾è¡¨çš„å¤§å°
                    containLabel: true
                },
                xAxis: { 
                    type: 'value', 
                    show: false, // éšè—Xè½´ï¼Œè®©ç”»é¢æ›´å¹²å‡€
                    splitLine: { show: false }
                },
                yAxis: { 
                    type: 'category', 
                    data: ['é¾™å²©å¸‚', 'å—å¹³å¸‚', 'ä¸‰æ˜å¸‚'], // æ’åæ•°æ®
                    axisLine: { show: false },
                    axisTick: { show: false },
                    axisLabel: { color: '#333', fontWeight: 'bold', interval: 0 }
                },

                visualMap: {
                    type: 'piecewise',
                    left: 30, bottom: 30,
                    itemWidth: 20, itemHeight: 14,
                    textGap: 10,
                    textStyle: { color: '#333' },
                    seriesIndex: [0], // ã€å…³é”®ã€‘åªæ§åˆ¶ç¬¬0ä¸ªç³»åˆ—(ä¹Ÿå°±æ˜¯åœ°å›¾)ï¼Œä¸å½±å“æŸ±çŠ¶å›¾é¢œè‰²
                    pieces: [
                        {min: 75, label: '> 75% (æé«˜)', color: '#005a32'},
                        {min: 60, max: 75, label: '60% - 75%', color: '#238b45'},
                        {min: 50, max: 60, label: '50% - 60%', color: '#74c476'},
                        {min: 40, max: 50, label: '40% - 50%', color: '#a1d99b'},
                        {max: 40, label: '< 40%', color: '#e5f5e0'}
                    ]
                },

                graphic: [
                    {
                        type: 'group', right: 40, top: 80,
                        children: [
                            { type: 'circle', position: [0, 0], shape: { cx: 0, cy: 0, r: 25 }, style: { fill: '#fff', stroke: '#999', lineWidth: 1, shadowBlur: 5, shadowColor: 'rgba(0,0,0,0.2)' } },
                            { type: 'polygon', shape: { points: [[0, -20], [-6, 0], [6, 0]] }, style: { fill: '#ff4d4f' } },
                            { type: 'polygon', shape: { points: [[0, 20], [-6, 0], [6, 0]] }, style: { fill: '#ccc' } },
                            { type: 'text', position: [0, -32], style: { text: 'N', font: 'bold 14px sans-serif', fill: '#333', textAlign: 'center' } }
                        ]
                    },
                    {
                        type: 'group', right: 40, bottom: 30,
                        children: [
                            { type: 'text', position: [0, -20], style: { text: '0      50     100 km', font: '12px sans-serif', fill: '#333' } },
                            { type: 'rect', shape: { x: 0, y: 0, width: 40, height: 6 }, style: { fill: '#333' } },
                            { type: 'rect', shape: { x: 40, y: 0, width: 40, height: 6 }, style: { fill: '#fff', stroke: '#333', lineWidth:1 } },
                            { type: 'rect', shape: { x: 80, y: 0, width: 40, height: 6 }, style: { fill: '#333' } },
                            { type: 'rect', shape: { x: 120, y:0, width: 6, height: 6 }, style: { fill: '#333' } }
                        ]
                    }
                ],

                series: [
                    // ã€ç³»åˆ— 0ï¼šåœ°å›¾ã€‘
                    {
                        name: 'æ£®æ—è¦†ç›–ç‡',
                        type: 'map',
                        map: 'fujian',
                        roam: true,
                        scaleLimit: { min: 0.8, max: 3 },
                        zoom: 1.2,
                        center: [118.2, 26.3],
                        label: { show: true, color: '#000', fontSize: 11 },
                        itemStyle: {
                            normal: { borderColor: '#797979', borderWidth: 0.5, areaColor: '#f3f3f3' },
                            emphasis: { areaColor: '#ffff00', shadowBlur: 10, borderWidth: 1.5, borderColor: '#fff' }
                        },
                        data: [
                            {name: 'é¾™å²©å¸‚', value: 79.21}, {name: 'å—å¹³å¸‚', value: 78.89},
                            {name: 'ä¸‰æ˜å¸‚', value: 77.12}, {name: 'å®å¾·å¸‚', value: 59.70},
                            {name: 'ç¦å·å¸‚', value: 51.77}, {name: 'æ¼³å·å¸‚', value: 50.80},
                            {name: 'æ³‰å·å¸‚', value: 48.50}, {name: 'è†ç”°å¸‚', value: 45.10},
                            {name: 'å¦é—¨å¸‚', value: 41.50}, {name: 'å¹³æ½­ç»¼åˆå®éªŒåŒº', value: 30.06}
                        ]
                    },
                    // ã€ç³»åˆ— 1ï¼šå·¦ä¸Šè§’æŸ±çŠ¶å›¾ã€‘
                    {
                        name: 'æ£®æ—è“„ç§¯é‡',
                        type: 'bar',
                        data: [1.57, 2.05, 2.10], // é¾™å²©, å—å¹³, ä¸‰æ˜
                        barWidth: 15, // æŸ±å­ç»†ä¸€ç‚¹ï¼Œç²¾è‡´
                        label: { 
                            show: true, position: 'right', 
                            formatter: '{c}', // åªæ˜¾ç¤ºæ•°å­—ï¼Œå•ä½åœ¨æ ‡é¢˜é‡Œäº†
                            fontSize: 12, fontWeight: 'bold', color: '#238b45'
                        },
                        itemStyle: {
                            // ç‹¬ç«‹çš„ç»¿è‰²æ¸å˜ï¼Œä¸å— visualMap å½±å“
                            color: new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                {offset: 0, color: '#238b45'},
                                {offset: 1, color: '#a1d99b'}
                            ]),
                            borderRadius: [0, 10, 10, 0]
                        },
                        z: 10 // æ‚¬æµ®åœ¨åœ°å›¾ä¸Šæ–¹
                    }
                ]
            };

            myChart.setOption(option);
        });

        window.addEventListener('resize', myChart.resize);
    </script>
</body>
</html>