<!DOCTYPE html>
<html style="height: 100%">
<head>
    <meta charset="utf-8">
    <title>福建省各市人均水资源量排名</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <style>
        .chart-footer {
            padding: 10px 20px;
            font-size: 12px;
            color: #666;
            background-color: #f8f9fa;
            border-top: 1px solid #e9ecef;
            font-family: "Microsoft YaHei", sans-serif;
        }
    </style>
</head>
<body style="height: 100%; margin: 0; display: flex; flex-direction: column;">
    <div id="container" style="flex: 1;"></div>
    
    <div class="chart-footer">
        <div><b>注：</b>红色警戒线为国际公认的“极度缺水标准”(500m³)。厦门、平潭已处于此线以下。</div>
        <div><b>数据来源：</b>基于《2023年福建省水资源公报》及各市2023年末常住人口计算。</div>
    </div>

    <script type="text/javascript">
        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);
        
        // 真实数据
        var data = [
            {name: '南平市', value: 8676},
            {name: '三明市', value: 6932},
            {name: '龙岩市', value: 5031},
            {name: '宁德市', value: 2711},
            {name: '漳州市', value: 1550},
            {name: '莆田市', value: 1182},
            {name: '福州市', value: 985},
            {name: '泉州市', value: 808},
            {name: '平潭', value: 498},
            {name: '厦门市', value: 229}
        ];

        var option = {
            backgroundColor: 'transparent',
            
            title: {
                text: '2023年福建省各设区市人均水资源量',
                left: 'center', top: 20,
                textStyle: { fontSize: 20, fontWeight: 'bold', color: '#333' },
                subtextStyle: { fontSize: 13, color: '#666' }
            },

            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(255,255,255,0.95)',
                borderColor: '#ccc', borderWidth: 1,
                formatter: function (params) {
                    var val = params[0].value;
                    // 自定义提示内容，缺水地区加个警告图标
                    var icon = val < 500 ? '⚠️ ' : ''; 
                    return params[0].name + '<br/>' + icon + '人均水资源: <b>' + val + '</b> m³';
                }
            },

            grid: { 
                left: '5%', right: '5%', bottom: '5%', top: '22%', 
                containLabel: true 
            },

            xAxis: {
                type: 'category',
                data: data.map(item => item.name),
                axisLabel: { interval: 0, color: '#333', fontWeight: 'bold' },
                axisTick: { show: false },
                axisLine: { lineStyle: { color: '#ccc' } }
            },

            yAxis: {
                type: 'value',
                name: 'm³/人',
                nameTextStyle: { align: 'right', padding: [0, 10, 0, 0] },
                splitLine: { lineStyle: { type: 'dashed', color: '#eee' } }
            },

            series: [{
                name: '人均水资源',
                type: 'bar',
                data: data.map(item => item.value),
                barWidth: '50%',
                
                // 【核心美化】
                itemStyle: {
                    borderRadius: [6, 6, 0, 0], // 圆角
                    color: function(params) {
                        // 智能判断颜色
                        if (params.value < 500) {
                            // 低于500：红色警示渐变
                            return new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                {offset: 0, color: '#ff7875'},
                                {offset: 1, color: '#d9363e'}
                            ]);
                        } else {
                            // 高于500：清爽蓝色渐变
                            return new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                {offset: 0, color: '#69c0ff'},
                                {offset: 1, color: '#1890ff'}
                            ]);
                        }
                    },
                    shadowBlur: 5,
                    shadowColor: 'rgba(0,0,0,0.1)',
                    shadowOffsetY: 3
                },

                label: { 
                    show: true, 
                    position: 'top', 
                    fontSize: 12, 
                    color: '#666',
                    formatter: '{c}'
                },

                // 【关键功能】标线 (MarkLine)
                markLine: {
                    symbol: ['none', 'none'], // 去掉箭头
                    label: {
                        position: 'insideEndTop', // 标签位置
                        formatter: '极度缺水线 (500 m³)',
                        color: '#ff4d4f',
                        fontSize: 12,
                        fontWeight: 'bold',
                        padding: [0, 10, 5, 0]
                    },
                    lineStyle: {
                        color: '#ff4d4f', // 红线
                        type: 'dashed',   // 虚线
                        width: 2
                    },
                    data: [
                        { yAxis: 500 } // 在 Y=500 处画线
                    ],
                    // 确保标线在最上层
                    z: 100
                }
            }]
        };
        
        myChart.setOption(option);
        window.addEventListener('resize', myChart.resize);
    </script>
</body>
</html>